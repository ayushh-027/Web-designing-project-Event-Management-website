<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Individual Services - Happy Moments</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="brand"><a href="homepage.html">Happy Moments</a></div>
        <div class="feedback-link">
            <a href="feedback.html">Give Feedback</a>
        </div>
    </header>

    <main>
        <section class="page-content">
            <h2>Services for Individuals</h2>
            
            <div class="filters">
                <label for="sort-by">Sort by:</label>
                <select id="sort-by" name="sort-by">
                    <option value="popularity">Popularity</option>
                    <option value="price_asc">Price (Low to High)</option>
                    <option value="price_desc">Price (High to Low)</option>
                </select>
            </div>

            <div class="service-list">
                <h3>Hotels</h3>
                <div class="service-item">
                    <h4>Grand Plaza Hotel (5-Star)</h4>
                    <p><strong>Facilities:</strong> Pool, Spa, Ballroom, 500-guest capacity.</p>
                    <p><strong>Price:</strong> Rs 5,10,000</p>
                </div>
                <h3>Resorts</h3>
                    <div class="service-item" data-price="677500" data-popularity="4">
                        <h4>Sunset Beach Resort (4-Star)</h4>
                        <p><strong>Facilities:</strong> Private beach, open-air dining, 200-guest capacity.</p>
                        <p><strong>Price:</strong> Rs 6,77,500</p>
                    </div>
                <h3>Banquet Halls</h3>
                <div class="service-item">
                    <h4>The Crystal Hall (Top-Rated)</h4>
                    <p><strong>Facilities:</strong> City center, A/V equipment, 300-guest capacity.</p>
                    <p><strong>Price:</strong> Rs 4,44,000</p>
                </div>
                <h3>Bouquets</h3>
                <div class="service-item">
                    <h4>Floral Dreams Packages</h4>
                    <p><strong>Facilities:</strong> Custom arrangements, delivery, setup.</p>
                    <p><strong>Price:</strong> Rs 50,500</p>
                </div>
            </div>
            <p class="contact-booking"><strong>Call 9998887770 for booking</strong></p>
                <script>
                    // Robust sorting for individual services
                    function parsePrice(item){
                                        if(!item) return Infinity;
                                        // prefer explicit data-price attribute when present
                                        if(item.dataset && item.dataset.price){
                                            var dp = item.dataset.price.toString().replace(/[^0-9]/g,'');
                                            if(dp) return parseInt(dp,10);
                                        }
                                        var ps = Array.from(item.querySelectorAll('p'));
                                        var priceText = '';
                                        for(var i=0;i<ps.length;i++){
                                            var t = ps[i].innerText || '';
                                            if(/price\s*[:]?/i.test(t) || /rs\s*/i.test(t) || /â‚¹/.test(t) || /\d+[,.]?\d*/.test(t)){
                                                priceText = t; break;
                                            }
                                        }
                                        if(!priceText) priceText = item.innerText || '';
                                        var num = priceText.replace(/[^0-9]/g,'');
                                        return num ? parseInt(num,10) : Infinity;
                    }

                    function parseStars(item){
                                        if(!item) return 0;
                                        // prefer explicit data-popularity attribute
                                        if(item.dataset && item.dataset.popularity){
                                            var dp = parseFloat(item.dataset.popularity);
                                            if(!isNaN(dp)) return dp;
                                        }
                                        var h4 = item.querySelector('h4');
                                        var title = h4 ? h4.innerText : '';
                                        var m = title.match(/(\d+(?:\.\d+)?)\s*-?\s*Star/i);
                                        if(m) return parseFloat(m[1]);
                                        if(/top\s*-?rated/i.test(title)) return 5;
                                        var p = Array.from(item.querySelectorAll('p')).find(function(x){ return /popularity/i.test(x.innerText); });
                                        if(p){ var mm = p.innerText.match(/(\d+(?:\.\d+)?)/); if(mm) return parseFloat(mm[1]); }
                                        return 0;
                    }

                    (function(){
                        var select = document.getElementById('sort-by');
                        if(!select) return;

                        select.addEventListener('change', function(){
                            var mode = select.value;
                            var container = document.querySelector('.service-list');
                            if(!container) return;

                            var children = Array.from(container.children);
                            var groups = [];
                            var current = null;
                            children.forEach(function(node){
                                if(node.tagName && node.tagName.toLowerCase() === 'h3'){
                                    current = {header: node, items: []}; groups.push(current);
                                } else if(node.classList && node.classList.contains('service-item')){
                                    if(!current){ current = {header: null, items: []}; groups.push(current); }
                                    current.items.push(node);
                                }
                            });

                            groups.forEach(function(g){
                                var items = g.items.slice();
                                items.sort(function(a,b){
                                    if(mode === 'price_asc' || mode === 'price_desc'){
                                        var pa = parsePrice(a);
                                        var pb = parsePrice(b);
                                        return mode === 'price_asc' ? pa - pb : pb - pa;
                                    } else if(mode === 'popularity'){
                                        var sa = parseStars(a);
                                        var sb = parseStars(b);
                                        return sb - sa;
                                    }
                                    return 0;
                                });

                                var ref = g.header ? g.header.nextSibling : container.firstChild;
                                if(ref && ref.nodeType === Node.TEXT_NODE) ref = ref.nextSibling;
                                items.forEach(function(it){ container.insertBefore(it, ref); ref = it.nextSibling; });
                            });
                        });

                        // initial sort
                        select.dispatchEvent(new Event('change'));
                    })();
                </script>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Happy Moments.</p>
    </footer>

</body>
</html>